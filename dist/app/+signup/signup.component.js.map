{"version":3,"file":"signup.component.js","sourceRoot":"","sources":["signup.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport {AngularFire, FirebaseAuth} from 'angularfire2';\nimport { RoleService } from '../role.service';\n@Component({\n  moduleId: module.id,\n  selector: 'app-signup',\n  templateUrl: 'signup.component.html',\n  styleUrls: ['signup.component.css']\n})\nexport class SignupComponent implements OnInit {\n  menuMain: any = {\n    'Home': ['Weld Entry', 'Welder Entry', 'NDE Batch', 'AB83 Batch'],\n    'Tools': ['Import', 'Export', 'Transfer Weld Data'],\n    'Settings': ['Project', 'Child Weld Type', 'Interchangeable Process', 'Parameter', 'Parameter Type', 'Pipe Heat', 'Schedule', 'Schedule Wall Thickness', 'Line Class', 'Service Type', 'Welder Symbol', 'Welder Qualification', 'Weld Procedure'],\n    'Reports': ['Report1'],\n    'More': ['User Setup', 'My Profile', 'About', 'Signup']\n  };\n  public errmsg: string =\"\";\n\n  fname: string;\n  lname: string;\n  email: string;\n  phone: string;\n  static uu: string;\n  uid: string;\n  constructor(public auth0: FirebaseAuth, public af: AngularFire, public rs: RoleService) {\n  }\n\n  ngOnInit() {\n    this.errmsg = \"\";\n  }\n  setup() {\n    let i: number = 0;\n    let j: number = 0;\n    for (var key in this.menuMain) {\n      i++;\n      // skip loop if the property is from prototype\n      if (!this.menuMain.hasOwnProperty(key)) continue;\n      // this.af.database.object(\"/menu/\" + key).update({\n      //   name: key\n      // });\n      var obj = this.menuMain[key];\n      j = 0;\n      //console.log(\"obj\" + obj );\n      for (var prop in obj) {\n        j++;\n        // skip loop if the property is from prototype\n        if (!obj.hasOwnProperty(prop)) continue;\n        this.af.database.object(\"/menu/\" + i.toString() + key + \"/\" + j.toString() + obj[prop]).update({\n          name: obj[prop]\n        });\n        //console.log(prop + \" = \" + obj[prop]);\n      }\n    }\n\n  }\n\n  signup(fname: string, lname: string, email: string, password: string, phone: string, address: string) {\n    if (!password || password === undefined) password = this.rs.clearPhone(phone);\n    let loginemail = this.rs.genEmail(phone);\n\n    this.af.auth.createUser({\n      email: loginemail,\n      password: password\n    }).then(function (authdata) {\n      SignupComponent.uu = authdata.uid;\n      localStorage.setItem('uid', authdata.uid);\n      console.log(\"this.uid:\" + SignupComponent.uu);\n      \n    }).catch(function (error) {\n      console.log(\"err:\" + JSON.stringify(error));\n      if (error !== null) {\n        switch (error.code) {\n          case \"INVALID_EMAIL\":\n            console.log(\"The specified email is not a valid email.\");\n            //this.errmsg = \"The specified phone is invalid.\";\n            break;\n          default:\n            // this.errmsg = \"Error creating user:\" + error;\n            console.log(\"Error creating user:\", error);\n            break;\n          case \"EMAIL_TAKEN\":\n            // this.errmsg = \"The new user account cannot be created because the phone is already in use. Use the credential to setup store.\";\n            console.log(\"The new user account cannot be created because the phone is already in use. Use the credential to setup store.\");\n            break;\n        }\n      }\n      return;\n    });\n  \n    setTimeout(() => {\n      //console.log(\"this.uid:\" + SignupComponent.uu + this.uid);\n      if (SignupComponent.uu !== undefined) {\n        this.uid = SignupComponent.uu\n      \n        //localStorage.setItem('uid', \"\");\n        this.af.auth.login({ email: loginemail, password: password }).then((authData) => {\n          //this.uid = authData.uid;\n\n\n          if (this.uid) {\n\n\n            //console.log(\"44\" + this.uid);\n            this.af.database.object(\"/users/\" + this.uid).update({\n              uid: this.uid,\n              email: email,\n              fname: fname,\n              lname: lname,\n              phone: phone,\n              role: 4,\n              ownerid: this.uid,\n              password: 'secret'\n            });\n\n\n            //this.parentRouter.navigateByUrl('/admin/Employees');\n\n          }\n        });\n      }\n    }, 2000);\n    \n    setTimeout(() => {\n      this.errmsg = \"\";\n    }, 5000);\n  \n  }\n}\n"]}